import{t}from"./i18n/index.js";export const ACHIEVEMENT_CATEGORIES={COMBAT:"combat",EXPLORATION:"exploration",PROGRESSION:"progression",MASTERY:"mastery",SPECIAL:"special"};export const ACHIEVEMENTS={FIRST_BLOOD:{id:"first_blood",get name(){return t("achievements.first_blood.name")},get description(){return t("achievements.first_blood.desc")},category:ACHIEVEMENT_CATEGORIES.COMBAT,icon:"âš”ï¸",condition:stats=>stats.enemiesDefeated>=1,reward:{fame:1}},SLAYER:{id:"slayer",get name(){return t("achievements.slayer.name")},get description(){return t("achievements.slayer.desc")},category:ACHIEVEMENT_CATEGORIES.COMBAT,icon:"ðŸ’€",condition:stats=>stats.enemiesDefeated>=10,reward:{fame:5}},PERFECT_COMBAT:{id:"perfect_combat",get name(){return t("achievements.perfect_combat.name")},get description(){return t("achievements.perfect_combat.desc")},category:ACHIEVEMENT_CATEGORIES.COMBAT,icon:"ðŸ›¡ï¸",condition:stats=>stats.perfectCombats>=1,reward:{fame:3}},DRAGON_SLAYER:{id:"dragon_slayer",get name(){return t("achievements.dragon_slayer.name")},get description(){return t("achievements.dragon_slayer.desc")},category:ACHIEVEMENT_CATEGORIES.COMBAT,icon:"ðŸ‰",condition:stats=>stats.dragonsDefeated>=1,reward:{fame:10}},EXPLORER:{id:"explorer",get name(){return t("achievements.explorer.name")},get description(){return t("achievements.explorer.desc")},category:ACHIEVEMENT_CATEGORIES.EXPLORATION,icon:"ðŸ—ºï¸",condition:stats=>stats.tilesExplored>=3,reward:{fame:2}},CARTOGRAPHER:{id:"cartographer",get name(){return t("achievements.cartographer.name")},get description(){return t("achievements.cartographer.desc")},category:ACHIEVEMENT_CATEGORIES.EXPLORATION,icon:"ðŸ§­",condition:stats=>stats.tilesExplored>=10,reward:{fame:5}},SITE_VISITOR:{id:"site_visitor",get name(){return t("achievements.site_visitor.name")},get description(){return t("achievements.site_visitor.desc")},category:ACHIEVEMENT_CATEGORIES.EXPLORATION,icon:"ðŸ›ï¸",condition:stats=>stats.sitesVisited>=5,reward:{fame:3}},LEVEL_UP:{id:"level_up",get name(){return t("achievements.level_up.name")},get description(){return t("achievements.level_up.desc")},category:ACHIEVEMENT_CATEGORIES.PROGRESSION,icon:"â­",condition:stats=>stats.level>=2,reward:{fame:2}},MASTER:{id:"master",get name(){return t("achievements.master.name")},get description(){return t("achievements.master.desc")},category:ACHIEVEMENT_CATEGORIES.PROGRESSION,icon:"ðŸŒŸ",condition:stats=>stats.level>=5,reward:{fame:10}},DECK_BUILDER:{id:"deck_builder",get name(){return t("achievements.deck_builder.name")},get description(){return t("achievements.deck_builder.desc")},category:ACHIEVEMENT_CATEGORIES.PROGRESSION,icon:"ðŸŽ´",condition:stats=>stats.totalCards>=20,reward:{fame:3}},SPEED_RUNNER:{id:"speed_runner",get name(){return t("achievements.speed_runner.name")},get description(){return t("achievements.speed_runner.desc")},category:ACHIEVEMENT_CATEGORIES.MASTERY,icon:"âš¡",condition:stats=>stats.victory&&stats.turns<=20,reward:{fame:15}},MANA_MASTER:{id:"mana_master",get name(){return t("achievements.mana_master.name")},get description(){return t("achievements.mana_master.desc")},category:ACHIEVEMENT_CATEGORIES.MASTERY,icon:"ðŸ”®",condition:stats=>stats.manaUsed>=50,reward:{fame:5}},CARD_MASTER:{id:"card_master",get name(){return t("achievements.card_master.name")},get description(){return t("achievements.card_master.desc")},category:ACHIEVEMENT_CATEGORIES.MASTERY,icon:"ðŸƒ",condition:stats=>stats.cardsPlayed>=100,reward:{fame:5}},SURVIVOR:{id:"survivor",get name(){return t("achievements.survivor.name")},get description(){return t("achievements.survivor.desc")},category:ACHIEVEMENT_CATEGORIES.SPECIAL,icon:"ðŸ’š",condition:stats=>stats.closeCallSurvival>=1,reward:{fame:5}},PACIFIST_WIN:{id:"pacifist_win",get name(){return t("achievements.pacifist_win.name")},get description(){return t("achievements.pacifist_win.desc")},category:ACHIEVEMENT_CATEGORIES.SPECIAL,icon:"â˜®ï¸",condition:stats=>stats.attackCardsPlayed===0&&stats.victory,reward:{fame:20}}};export class AchievementManager{constructor(){this.unlockedAchievements=new Set;this.notifications=[];this.achievements=ACHIEVEMENTS;this.load()}checkAchievements(stats){const newlyUnlocked=[];Object.values(ACHIEVEMENTS).forEach(achievement=>{if(this.unlockedAchievements.has(achievement.id)){return}if(achievement.condition(stats)){this.unlock(achievement.id);newlyUnlocked.push(achievement)}});return newlyUnlocked}isUnlocked(id){return this.unlockedAchievements.has(id)}unlock(achievementId){if(this.unlockedAchievements.has(achievementId)){return false}this.unlockedAchievements.add(achievementId);this.save();const achievement=ACHIEVEMENTS[achievementId.toUpperCase()]||Object.values(ACHIEVEMENTS).find(a=>a.id===achievementId);if(achievement){this.addNotification(achievement)}return true}addNotification(achievement){this.notifications.push({achievement:achievement,timestamp:Date.now()});if(this.notifications.length>10){this.notifications.shift()}}getUnlocked(){return Array.from(this.unlockedAchievements).map(id=>Object.values(ACHIEVEMENTS).find(a=>a.id===id)).filter(Boolean)}getLocked(){return Object.values(ACHIEVEMENTS).filter(achievement=>!this.unlockedAchievements.has(achievement.id))}getProgress(){const total=Object.keys(ACHIEVEMENTS).length;const unlocked=this.unlockedAchievements.size;return{unlocked:unlocked,total:total,percentage:Math.round(unlocked/total*100)}}getByCategory(category){return Object.values(ACHIEVEMENTS).filter(a=>a.category===category)}getPendingNotifications(){const pending=[...this.notifications];this.notifications=[];return pending}save(){try{const data={unlocked:Array.from(this.unlockedAchievements),timestamp:Date.now()};localStorage.setItem("mageKnight_achievements",JSON.stringify(data))}catch(error){console.error("Failed to save achievements:",error)}}load(){try{const data=localStorage.getItem("mageKnight_achievements");if(data){const parsed=JSON.parse(data);this.unlockedAchievements=new Set(parsed.unlocked||[])}}catch(error){console.error("Failed to load achievements:",error);this.unlockedAchievements=new Set}}reset(){this.unlockedAchievements.clear();this.notifications=[];this.save()}getState(){return{unlocked:Array.from(this.unlockedAchievements)}}loadState(state){if(!state||!state.unlocked)return;this.unlockedAchievements=new Set(state.unlocked)}}export default AchievementManager;