import{logger}from"./logger.js";export class ErrorHandler{constructor(game){this.game=game;this.errors=[];this.maxErrors=50;this.setupGlobalHandlers()}setupGlobalHandlers(){window.addEventListener("error",event=>{this.handleError({type:"error",message:event.message,filename:event.filename,line:event.lineno,col:event.colno,stack:event.error?.stack})});window.addEventListener("unhandledrejection",event=>{this.handleError({type:"promise",message:event.reason?.message||String(event.reason),stack:event.reason?.stack})});logger.info("üõ°Ô∏è Error handler initialized")}handleError(errorInfo){this.errors.push({...errorInfo,timestamp:(new Date).toISOString()});if(this.errors.length>this.maxErrors){this.errors.shift()}logger.error(`[${errorInfo.type}] ${errorInfo.message}`);if(this.game?.showToast){this.game.showToast("Ein Fehler ist aufgetreten. Siehe Konsole f√ºr Details.","error")}if(this.game?.addLog){this.game.addLog(`Fehler: ${errorInfo.message}`,"error")}}getErrors(){return[...this.errors]}clearErrors(){this.errors=[]}getErrorCount(){return this.errors.length}}