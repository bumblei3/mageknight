import{getRandomSkills}from"../skills/skillDefinitions.js";import{SkillSelectionModal}from"../ui/SkillSelectionModal.js";export class LevelUpManager{constructor(game){this.game=game;this.skillModal=new SkillSelectionModal;this.currentLevel=0}async handleLevelUp(newLevelData){this.currentLevel=newLevelData.newLevel;this.game.addLog(`â­ Level ${this.currentLevel} erreicht!`,"success");if(this.game.particleSystem){this.game.particleSystem.levelUpEffect(window.innerWidth/2,window.innerHeight/2)}const currentSkillIds=new Set(this.game.hero.skills.map(s=>s.id));const skillOffer=getRandomSkills("goldyx",currentSkillIds,2);if(typeof this.renderSkills==="function")this.renderSkills(skillOffer);const cardOffer=this.game.rewardManager?this.game.rewardManager.getAdvancedActionOffer(3):[];if(typeof this.renderCards==="function")this.renderCards(cardOffer);if(skillOffer.length>0){if(this.game.isTestEnvironment){this.updateConfirmButton();return}const selectedSkill=await this.skillModal.show(skillOffer);if(selectedSkill){this.selectedSkill=selectedSkill;this.confirmSelection()}}this.game.updateStats()}confirmSelection(selection){const skill=selection?.skill||this.selectedSkill;const card=selection?.card||this.selectedCard;this.game.hero.levelUp();if(skill){this.game.hero.addSkill(skill);this.game.addLog(`Skill gelernt: ${skill.name}`,"success")}if(card){this.game.hero.addCardToDeck(card);this.game.addLog(`Karte gelernt: ${card.name}`,"success")}this.selectedSkill=null;this.selectedCard=null;this.game.updateStats()}renderSkills(_skills){}renderCards(_cards){}updateConfirmButton(){if(this.confirmBtn){this.confirmBtn.disabled=!(this.selectedSkill&&this.selectedCard)}}}