import{SAMPLE_ARTIFACTS,SAMPLE_SPELLS,SAMPLE_ADVANCED_ACTIONS,Card}from"../card.js";import{logger}from"../logger.js";import{t}from"../i18n/index.js";export class RewardManager{constructor(game){this.game=game;this.modal=document.getElementById("reward-modal");this.choicesContainer=document.getElementById("reward-choices");this.selectedCard=null;this.artifactsOffer=[]}showSpellChoice(choiceCount=2){logger.info("Opening spell reward selection modal...");const shuffled=[...SAMPLE_SPELLS].sort(()=>.5-Math.random());this.artifactsOffer=shuffled.slice(0,choiceCount);this.renderChoices(true);if(this.modal){this.modal.classList.add("active")}}showArtifactChoice(choiceCount=2){logger.info("Opening reward selection modal...");const shuffled=[...SAMPLE_ARTIFACTS].sort(()=>.5-Math.random());this.artifactsOffer=shuffled.slice(0,choiceCount);this.renderChoices(false);if(this.modal){this.modal.classList.add("active")}}renderChoices(isSpell=false){if(!this.choicesContainer)return;this.choicesContainer.innerHTML="";this.artifactsOffer.forEach(cardData=>{const card=new Card(cardData);const el=document.createElement("div");el.className="choice-item reward-card";el.innerHTML=`\n                <div class="reward-card-inner" data-type="${isSpell?"spell":"artifact"}">\n                    <div class="card-header" style="background-color: var(--color-mana-${card.color})">\n                        <span class="card-name">${card.name}</span>\n                    </div>\n                    <div class="card-body">\n                        <div class="card-desc">${card.getFormattedText?card.getFormattedText():card.description}</div>\n                    </div>\n                    <div class="card-footer">\n                        <span class="card-type">${isSpell?t("cards.types.spell"):t("ui.labels.artifact")}</span>\n                    </div>\n                </div>\n                <div class="selection-overlay">WÃ¤hlen</div>\n            `;el.onclick=()=>this.selectReward(card,isSpell);this.choicesContainer.appendChild(el)})}selectReward(card,isSpell=false){this.game.hero.addCardToDeck(card);this.game.addLog(t("combat.rewardClaimed",{card:card.name}),"success");if(this.modal){this.modal.classList.remove("active")}this.game.updateStats();this.game.render();if(this.game.particleSystem){const heroPixel=this.game.hexGrid.axialToPixel(this.game.hero.position.q,this.game.hero.position.r);this.game.particleSystem.buffEffect(heroPixel.x,heroPixel.y,isSpell?card.color:"gold")}}selectArtifact(card){this.selectReward(card,false)}getAdvancedActionOffer(count=3){const shuffled=[...SAMPLE_ADVANCED_ACTIONS].sort(()=>.5-Math.random());return shuffled.slice(0,count)}}