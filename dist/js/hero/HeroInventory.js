import{MANA_COLORS}from"../mana.js";import{createDeck,SAMPLE_ARTIFACTS}from"../card.js";export class HeroInventory{constructor(){this.crystals={red:0,blue:0,white:0,green:0};this.tempMana=[]}addCrystal(color){if(this.crystals[color]!==undefined&&this.crystals[color]<3){this.crystals[color]++;return true}return false}useCrystal(color){if(this.crystals[color]>0){this.crystals[color]--;return true}return false}getCrystals(){return{...this.crystals}}takeManaFromSource(color){if(!Object.values(MANA_COLORS).includes(color)){return false}this.tempMana.push(color);return true}hasMana(requiredColor,isNight=false){if(!requiredColor)return false;return this.tempMana.some(m=>m===requiredColor||!isNight&&m===MANA_COLORS.GOLD)}canAffordMana(card,isNight=false){if(!card.manaCost||card.manaCost===0)return true;return this.hasMana(card.color,isNight)}spendMana(requiredColor,isNight=false){if(!requiredColor)return false;let index=this.tempMana.indexOf(requiredColor);if(index===-1&&!isNight){index=this.tempMana.indexOf(MANA_COLORS.GOLD)}if(index!==-1){this.tempMana.splice(index,1);return true}return false}clearTempMana(){this.tempMana=[]}getManaInventory(){const inventory={};this.tempMana.forEach(color=>{inventory[color]=(inventory[color]||0)+1});return inventory}awardRandomArtifact(discardPile){const randomArt=SAMPLE_ARTIFACTS[Math.floor(Math.random()*SAMPLE_ARTIFACTS.length)];const card=createDeck([randomArt])[0];discardPile.push(card);return card}getState(){return{crystals:{...this.crystals},tempMana:[...this.tempMana]}}loadState(state){if(!state)return;if(state.crystals)this.crystals={...state.crystals};if(state.tempMana)this.tempMana=[...state.tempMana]}reset(){this.crystals={red:0,blue:0,white:0,green:0};this.tempMana=[]}}