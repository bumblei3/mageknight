import{createUnit}from"../unit.js";import{createDeck}from"../card.js";export class BaseSiteHandler{constructor(game){this.game=game}getOptions(_site){return[]}healWounds(costPerWound){if(this.game.hero.influencePoints>=costPerWound&&this.game.hero.wounds.length>0){if(this.game.hero.healWound(false)){this.game.hero.influencePoints-=costPerWound;const msg="Wunde geheilt!";this.game.addLog(msg,"success");return{success:true,message:msg}}}return{success:false,message:"Nicht genug Einfluss oder keine Wunden."}}recruitUnit(unitInfo){if(this.game.hero.influencePoints>=unitInfo.cost){const instance=unitInfo.create?unitInfo.create():createUnit(unitInfo.type);if(!instance){return{success:false,message:"Einheiten-Typ unbekannt."}}instance.id=`${unitInfo.type}_${Date.now()}_${Math.floor(Math.random()*1e3)}`;if(this.game.hero.addUnit(instance)){this.game.hero.influencePoints-=unitInfo.cost;const msg=`Einheit ${instance.name||instance.getName()} rekrutiert!`;this.game.addLog(msg,"success");this.game.updateStats();return{success:true,message:msg}}else{return{success:false,message:"Kein Platz für weitere Einheiten (Command Limit)."}}}return{success:false,message:"Nicht genug Einfluss."}}buyCard(cardData,cost){let manaColor=cardData.color;const isSpell=cardData.type==="spell";if(isSpell){const inventory=this.game.hero.getManaInventory();const hasToken=inventory.includes(manaColor);const hasCrystal=this.game.hero.crystals[manaColor.toUpperCase()]>0||this.game.hero.crystals[manaColor.toLowerCase()]>0;if(!hasToken&&!hasCrystal){return{success:false,message:`Du benötigst ein ${manaColor}-Mana (oder Kristall) zum Lernen!`}}if(hasToken){this.game.hero.removeMana(manaColor)}else{const cryKey=this.game.hero.crystals[manaColor.toUpperCase()]!==undefined?manaColor.toUpperCase():manaColor.toLowerCase();this.game.hero.crystals[cryKey]--}}if(this.game.hero.influencePoints>=cost){const card=createDeck([cardData])[0];this.game.hero.discard.push(card);this.game.hero.influencePoints-=cost;const msg=`Karte ${card.name} gelernt!`;this.game.addLog(msg,"success");return{success:true,message:msg}}return{success:false,message:"Nicht genug Einfluss."}}}